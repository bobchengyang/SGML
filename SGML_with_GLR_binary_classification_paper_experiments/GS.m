%=================================================================
% Signed Graph Metric Learing (SGML) via Gershgorin Disc Alignment
% **Frank-Wolfe step size optimization with golden section search
%
% author: Cheng Yang
% email me any questions: cheng.yang@ieee.org
% date: June 16th, 2020
% please kindly cite the paper: 
% ['Signed Graph Metric Learning via Gershgorin Disc Alignment', 
% Cheng Yang, Gene Cheung, Wei Hu, 
% https://128.84.21.199/abs/2006.08816]
%=================================================================
function [gamma] = GS(...
    xL,...
    xU,...
    M_previous,...
    t_M21_solution_previous,...
    M_lc,...
    x,...
    feature_N,...
    BCD,...
    remaining_idx,...
    tol_golden_search,...
    zero_mask,...
    zz,...
    total_offdia,...
    partial_sample,...
    c,...
    dia_idx,...
    nv)

R=0.5*(sqrt(5)-1);
d=R*(xU-xL);
x1=xU-d;
x2=xL+d;

f1=obj_value(...
    x1,...
    M_previous,...
    t_M21_solution_previous,...
    M_lc,...
    x,...
    feature_N,...
    BCD,...
    remaining_idx,...
    zero_mask,...
    zz,...
    total_offdia,...
    partial_sample,...
    c,...
    dia_idx,...
    nv);

f2=obj_value(...
    x2,...
    M_previous,...
    t_M21_solution_previous,...
    M_lc,...
    x,...
    feature_N,...
    BCD,...
    remaining_idx,...
    zero_mask,...
    zz,...
    total_offdia,...
    partial_sample,...
    c,...
    dia_idx,...
    nv);

err=Inf;
ni=0;
while err>tol_golden_search
    ni=ni+1;
    if f1<f2
        xU=x2;
        %fU=f2;
        x2=x1;
        f2=f1;
        d=R*(xU-xL);
        x1=xU-d;
        f1=obj_value(...
            x1,...
            M_previous,...
            t_M21_solution_previous,...
            M_lc,...
            x,...
            feature_N,...
            BCD,...
            remaining_idx,...
            zero_mask,...
            zz,...
            total_offdia,...
            partial_sample,...
            c,...
            dia_idx,...
            nv);
        
    elseif f1>f2
        xL=x1;
        %fL=f1;
        x1=x2;
        f1=f2;
        d=R*(xU-xL);
        x2=xL+d;
        f2=obj_value(...
            x2,...
            M_previous,...
            t_M21_solution_previous,...
            M_lc,...
            x,...
            feature_N,...
            BCD,...
            remaining_idx,...
            zero_mask,...
            zz,...
            total_offdia,...
            partial_sample,...
            c,...
            dia_idx,...
            nv);
    else
        xL=(x1+x2)/2;
        xU=xL;
    end
    err=2*abs(xU-xL)/(xU+xL);
end
gamma=(x1+x2)/2;
%disp([num2str(ni) ' golden section search iterations']);
end

