function [ M, scaled_M, scaled_factors, M_current_eigenvector, ...
    league_vec,...
    bins,...
    time_lp,...
    time_gs,...
    time_grad] = ...
    optimization_M_MLjournal_subgraph_nocycle_after(...
    feature_N,...
    M,...
    scaled_M,...
    bins,...
    scaled_factors,...
    rho,...
    tol_offdiagonal,...
    M_current_eigenvector,...
    league_vec,...
    lobpcg_random_control,...
    tol_golden_search,...
    S_upper,...
    time_lp,...
    time_gs,...
    time_grad,...
    time_i,...
    nv,...
    zz,...
    D,...
    options)

objective_previous = dml_obj(M,D);
tic;
[ G ] = dml_gradient(...
    M, ...
    D, ...
    feature_N, ...
    nv, ...
    0, ...
    0);

G=-G;

time_grad(time_i)=time_grad(time_i)+toc;
[M,...
    scaled_M,...
    scaled_factors,...
    bins,...
    objective_temp,...
    time_lp,...
    time_gs,...
    time_grad] = optimization_M_ns_cell_MLjournal_subgraph_FULL_gs_ws(league_vec,...
    scaled_M,...
    bins,...
    scaled_factors,...
    feature_N,...
    G,...
    M,...
    rho,...
    lobpcg_random_control,...
    tol_golden_search,...
    objective_previous,...
    S_upper,...
    time_lp,...
    time_gs,...
    time_grad,...
    time_i,...
    nv,...
    zz,...
    D,...
    options);

end




