%=================================================================
% Signed Graph Metric Learing (SGML) via Gershgorin Disc Alignment
% **Frank-Wolfe step size optimization with gradient descent
%
% author: Cheng Yang
% email me any questions: cheng.yang@ieee.org
% date: June 16th, 2020
% please kindly cite the paper: 
% ['Signed Graph Metric Learning via Gershgorin Disc Alignment', 
% Cheng Yang, Gene Cheung, Wei Hu, 
% https://128.84.21.199/abs/2006.08816]
%=================================================================
function [gamma] = gamma_GD(...
    M_previous,...
    gamma,...
    t_M21_solution_previous,...
    zero_mask,...
    remaining_idx,...
    BCD,...
    feature_N,...
    M_lc,...
    zz,...
    nv,...
    partial_sample,...
    c,...
    y,...
    dia_idx,...
    tol_GD,...
    total_offdia)

gL=0;
gU=1;
nn=0;
while abs(gL-gU)>tol_GD
    nn=nn+1;
    gamma=(gL+gU)/2;
    [G_gM] = get_gamma_first_derivative(...
        M_previous,...
        gamma,...
        t_M21_solution_previous,...
        zero_mask,...
        remaining_idx,...
        BCD,...
        feature_N,...
        M_lc,...
        zz,...
        nv,...
        partial_sample,...
        c,...
        y,...
        dia_idx,...
    total_offdia);
    if G_gM>0 % fmin=f(gamma\in[gL,gamma])
        gU=gamma;
    elseif G_gM<0 % fmin=f(gamma\in[gamma,gU])
        gL=gamma;
    else % G_gM=0
        %gamma=gM;
        break
    end
end

end

